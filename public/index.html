<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ComicCaster - RSS feeds for your favorite comics</title>
    <meta name="description" content="Your daily comics, minus the 47 browser tabs. Subscribe to 100+ comics from GoComics, Comics Kingdom, and more via RSS.">
    
    <!-- Open Graph -->
    <meta property="og:title" content="ComicCaster">
    <meta property="og:description" content="Your daily comics, minus the 47 browser tabs.">
    <meta property="og:image" content="https://comiccaster.xyz/images/og-image.jpg">
    <meta property="og:url" content="https://comiccaster.xyz">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="ComicCaster">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ComicCaster">
    <meta name="twitter:description" content="Your daily comics, minus the 47 browser tabs.">
    <meta name="twitter:image" content="https://comiccaster.xyz/images/og-image.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg">
    <link rel="alternate icon" type="image/x-icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/comic-theme.css">
</head>
<body>
    <!-- Notification banner - uncomment when needed -->
    <!-- <div class="notification-banner">
        Some feeds wandered off and haven't updated for a few days. Possibly abducted by cows. ğŸ„ Possibly just broken. (But you never know with cows and their cow tools ğŸ®) Either way, we're investigating. See our scribbles here: <a href="https://github.com/adamprime/comiccaster/issues/46" target="_blank">GitHub #46</a>
    </div> -->
    <div class="container">
        <header class="header">
            <h1>ComicCaster</h1>
            <p>Read your favorite comics as an RSS feed</p>
            <nav class="header-nav">
                <a href="https://dispatch.comiccaster.xyz">ğŸ“° Dispatch Blog</a>
                <a href="https://dispatch.comiccaster.xyz/getting-started/">ğŸ“– Guides</a>
                <a href="https://feedback.comiccaster.xyz">ğŸ’¬ Feedback</a>
            </nav>
        </header>

        <div class="card">
            <div class="card-header">
                <h2>ğŸ‰ Welcome to ComicCaster</h2>
                <p>Turn your daily comics into a feed you'll actually keep up with.</p>
            </div>
            <div class="card-body" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <a href="https://dispatch.comiccaster.xyz/getting-started/" class="btn btn-primary">ğŸš€ Get Started</a>
                <a href="https://dispatch.comiccaster.xyz/guides/what-is-rss/" class="btn btn-secondary">ğŸ¤” What's RSS?</a>
                <a href="https://dispatch.comiccaster.xyz/blog/" class="btn btn-secondary">ğŸ“° Latest Updates</a>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2>ğŸ—‚ï¸ Browse All Comic Feeds</h2>
                <p>Grab an RSS link for any individual comic below. Perfect for reading in your own RSS reader like Feedly, NetNewsWire, or Reeder.</p>
            </div>
            <div class="card-body">
                <div class="tabs">
                    <button class="tab-button active" data-tab="daily">ğŸ“° Daily Comics</button>
                    <button class="tab-button" data-tab="political">ğŸ›ï¸ Political Cartoons</button>
                    <button class="tab-button" data-tab="spanish">ğŸ‡ªğŸ‡¸ Spanish Comics</button>
                    <button class="tab-button" data-tab="tinyview">ğŸ“± TinyView</button>
                </div>
                <div class="tab-content active" id="daily-tab">
                    <input type="text" id="comicSearch" placeholder="Search daily comics...">
                    <div class="table-container">
                        <table class="table" id="comics-table">
                            <thead>
                                <tr>
                                    <th>Comic</th>
                                    <th>ğŸ”— Source</th>
                                    <th>ğŸ“¡ RSS Link</th>
                                </tr>
                            </thead>
                            <tbody id="comics-table-body">
                                <!-- Comic rows will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-content" id="political-tab">
                    <input type="text" id="politicalComicSearch" placeholder="Search political cartoons...">
                    <div class="table-container">
                        <table class="table" id="political-comics-table">
                            <thead>
                                <tr>
                                    <th>Comic</th>
                                    <th>ğŸ”— Source</th>
                                    <th>ğŸ“¡ RSS Link</th>
                                </tr>
                            </thead>
                            <tbody id="political-comics-table-body">
                                <!-- Political comic rows will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-content" id="spanish-tab">
                    <input type="text" id="spanishComicSearch" placeholder="Search Spanish comics...">
                    <div class="table-container">
                        <table class="table" id="spanish-comics-table">
                            <thead>
                                <tr>
                                    <th>Comic</th>
                                    <th>ğŸ”— Source</th>
                                    <th>ğŸ“¡ RSS Link</th>
                                </tr>
                            </thead>
                            <tbody id="spanish-comics-table-body">
                                <!-- Spanish comic rows will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-content" id="tinyview-tab">
                    <input type="text" id="tinyviewComicSearch" placeholder="Search TinyView comics...">
                    <div class="table-container">
                        <table class="table" id="tinyview-comics-table">
                            <thead>
                                <tr>
                                    <th>Comic</th>
                                    <th>ğŸ”— Source</th>
                                    <th>ğŸ“¡ RSS Link</th>
                                </tr>
                            </thead>
                            <tbody id="tinyview-comics-table-body">
                                <!-- Tinyview comic rows will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2>ğŸ“š Build Your Comic Bundle</h2>
                <p>Select your favorite comics below and click the button to generate an OPML file. It works like a playlist for your RSS readerâ€”you can import them all at once!</p>
            </div>
            <div class="card-body">
                <div class="tabs">
                    <button class="tab-button opml-tab active" data-tab="daily-opml">ğŸ“° Daily Comics</button>
                    <button class="tab-button opml-tab" data-tab="political-opml">ğŸ›ï¸ Political Cartoons</button>
                    <button class="tab-button opml-tab" data-tab="spanish-opml">ğŸ‡ªğŸ‡¸ Spanish Comics</button>
                    <button class="tab-button opml-tab" data-tab="tinyview-opml">ğŸ“± TinyView</button>
                </div>
                <div class="tab-content opml-content active" id="daily-opml-tab">
                    <input type="text" id="customFeedSearch" placeholder="Search daily comics by name...">
                    <div class="comic-list" id="comics-list">
                        <!-- Comics checkboxes will be populated dynamically -->
                    </div>

                    <button class="btn btn-primary" id="generateOPMLBtn">ğŸ“„ Generate Daily Comics OPML</button>
                    <button class="btn btn-secondary" id="resetSelectionBtn">âŒ Clear Selection</button>
                    
                    <div id="success-message" class="success-message">
                        <p>âœ… Your OPML file is ready! <a href="#" id="download-link">Click here to download it</a>. Then import it into your RSS reader and enjoy the comics!</p>
                    </div>
                </div>
                <div class="tab-content opml-content" id="political-opml-tab">
                    <input type="text" id="politicalFeedSearch" placeholder="Search political cartoons by name...">
                    <div class="comic-list" id="political-comics-list">
                        <!-- Political comics checkboxes will be populated dynamically -->
                    </div>

                    <button class="btn btn-primary" id="generatePoliticalOPMLBtn">ğŸ“„ Generate Political Cartoons OPML</button>
                    <button class="btn btn-secondary" id="resetPoliticalSelectionBtn">âŒ Clear Selection</button>
                    
                    <div id="political-success-message" class="success-message">
                        <p>âœ… Your OPML file is ready! <a href="#" id="political-download-link">Click here to download it</a>. Then import it into your RSS reader and enjoy the political cartoons!</p>
                    </div>
                </div>
                <div class="tab-content opml-content" id="spanish-opml-tab">
                    <input type="text" id="spanishFeedSearch" placeholder="Search Spanish comics by name...">
                    <div class="comic-list" id="spanish-comics-list">
                        <!-- Spanish comics checkboxes will be populated dynamically -->
                    </div>

                    <button class="btn btn-primary" id="generateSpanishOPMLBtn">ğŸ“„ Generate Spanish Comics OPML</button>
                    <button class="btn btn-secondary" id="resetSpanishSelectionBtn">âŒ Clear Selection</button>
                    
                    <div id="spanish-success-message" class="success-message">
                        <p>âœ… Your OPML file is ready! <a href="#" id="spanish-download-link">Click here to download it</a>. Then import it into your RSS reader and enjoy the Spanish comics!</p>
                    </div>
                </div>
                <div class="tab-content opml-content" id="tinyview-opml-tab">
                    <input type="text" id="tinyviewFeedSearch" placeholder="Search TinyView comics by name...">
                    <div class="comic-list" id="tinyview-comics-list">
                        <!-- Tinyview comics checkboxes will be populated dynamically -->
                    </div>

                    <button class="btn btn-primary" id="generateTinyviewOPMLBtn">ğŸ“„ Generate TinyView Comics OPML</button>
                    <button class="btn btn-secondary" id="resetTinyviewSelectionBtn">âŒ Clear Selection</button>
                    
                    <div id="tinyview-success-message" class="success-message">
                        <p>âœ… Your OPML file is ready! <a href="#" id="tinyview-download-link">Click here to download it</a>. Then import it into your RSS reader and enjoy the TinyView comics!</p>
                    </div>
                </div>

                <div class="help-text">
                    <h3>ğŸ§  What's an OPML file?</h3>
                    <p>It's like a playlist for RSS readers. This file lets you subscribe to multiple comics at onceâ€”no need to copy and paste each link manually. Just import it into Feedly, Reeder, NetNewsWire, or any RSS reader that supports OPML, and start reading.</p>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>Made with â¤ï¸ by <a href="https://github.com/adamprime/comiccaster">ComicCaster</a></p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let dailyComics = [];
            let politicalComics = [];
            let spanishComics = [];
            let tinyviewComics = [];
            
            // Load all four types of comics data
            Promise.all([
                fetch('/comics_list.json').then(r => r.json()),
                fetch('/political_comics_list.json').then(r => r.json()),
                fetch('/spanish_comics_list.json').then(r => r.json()).catch(() => []), // Fallback to empty array if file doesn't exist yet
                fetch('/tinyview_comics_list.json').then(r => r.json()).catch(() => []) // Fallback to empty array if file doesn't exist yet
            ])
            .then(([daily, political, spanish, tinyview]) => {
                // Combine daily comics from all sources (GoComics + TinyView)
                // This includes Comics Kingdom and Far Side which are in the daily list with source tags
                const allDailyComics = [...daily, ...tinyview].sort((a, b) => a.name.localeCompare(b.name));
                
                // Sort all comics alphabetically by name
                dailyComics = allDailyComics;
                politicalComics = political.sort((a, b) => a.name.localeCompare(b.name));
                spanishComics = spanish.sort((a, b) => a.name.localeCompare(b.name));
                tinyviewComics = tinyview.sort((a, b) => a.name.localeCompare(b.name));
                
                // Populate tables and lists (all with Source column for consistency)
                populateComicsTable(dailyComics, 'comics-table-body', 'all');
                populateComicsTable(politicalComics, 'political-comics-table-body', 'all');
                populateComicsTable(spanishComics, 'spanish-comics-table-body', 'all');
                populateComicsTable(tinyviewComics, 'tinyview-comics-table-body', 'tinyview');
                populateComicsList(dailyComics, 'comics-list');
                populateComicsList(politicalComics, 'political-comics-list');
                populateComicsList(spanishComics, 'spanish-comics-list');
                populateComicsList(tinyviewComics, 'tinyview-comics-list');
                
                // Setup functionality
                setupTabSwitching();
                setupSearch();
                setupOPMLGeneration();
            })
            .catch(error => {
                console.error('Error fetching comics:', error);
            });
            
            function populateComicsTable(comics, tableBodyId, source = 'gocomics') {
                const tableBody = document.getElementById(tableBodyId);
                tableBody.innerHTML = '';
                
                comics.forEach(comic => {
                    const row = document.createElement('tr');
                    
                    // Determine source display name and URL
                    let sourceName = 'GoComics';
                    let sourceUrl;
                    let feedPath;
                    
                    if (comic.source === 'comicskingdom') {
                        sourceName = 'Comics Kingdom';
                        sourceUrl = `https://comicskingdom.com/${comic.slug}`;
                        feedPath = `/feeds/${comic.slug}.xml`;
                    } else if (comic.source === 'tinyview') {
                        sourceName = 'TinyView';
                        sourceUrl = comic.url;
                        feedPath = `/feeds/${comic.slug}.xml`;
                    } else if (comic.source === 'farside') {
                        sourceName = 'Far Side';
                        sourceUrl = comic.url || 'https://www.thefarside.com/';
                        feedPath = `/feeds/${comic.slug}.xml`;
                    } else {
                        sourceName = 'GoComics';
                        sourceUrl = `https://www.gocomics.com/${comic.slug}`;
                        feedPath = `/rss/${comic.slug}`;
                    }
                    
                    const feedUrl = `https://comiccaster.xyz${feedPath}`;
                    
                    row.innerHTML = `
                        <td>${comic.name}</td>
                        <td><a href="${sourceUrl}" target="_blank">ğŸ”— ${sourceName}</a></td>
                        <td>
                            <div class="feed-url">
                                <span class="copy-icon" onclick="copyToClipboard(this)" data-url="${feedUrl}">ğŸ“‹</span>
                                <span class="url-text" onclick="copyToClipboard(this)" data-url="${feedUrl}">
                                    ${feedUrl}
                                </span>
                                <a href="/preview.html?url=${feedUrl}" class="preview-link" target="_blank">ğŸ‘ï¸ Preview</a>
                            </div>
                        </td>
                    `;
                    row.dataset.name = comic.name.toLowerCase();
                    row.dataset.source = source;
                    tableBody.appendChild(row);
                });
            }
            
            function populateComicsList(comics, listId) {
                const comicsList = document.getElementById(listId);
                comicsList.innerHTML = '';
                
                comics.forEach(comic => {
                    const checkboxItem = document.createElement('div');
                    checkboxItem.className = 'form-check';
                    checkboxItem.dataset.name = comic.name.toLowerCase();
                    let prefix = 'comic';
                    if (listId === 'political-comics-list') {
                        prefix = 'political';
                    } else if (listId === 'tinyview-comics-list') {
                        prefix = 'tinyview';
                    } else if (listId === 'spanish-comics-list') {
                        prefix = 'spanish';
                    }
                    
                    // Determine source name for display
                    let sourceName = '';
                    if (comic.source === 'comicskingdom') {
                        sourceName = ' <span class="source-tag">(Comics Kingdom)</span>';
                    } else if (comic.source === 'tinyview') {
                        sourceName = ' <span class="source-tag">(TinyView)</span>';
                    } else if (comic.source === 'farside') {
                        sourceName = ' <span class="source-tag">(Far Side)</span>';
                    } else {
                        sourceName = ' <span class="source-tag">(GoComics)</span>';
                    }
                    
                    checkboxItem.innerHTML = `
                        <input class="form-check-input" type="checkbox" value="${comic.slug}" id="${prefix}-${comic.slug}">
                        <label class="form-check-label" for="${prefix}-${comic.slug}">
                            ${comic.name}${sourceName}
                        </label>
                    `;
                    comicsList.appendChild(checkboxItem);
                });
            }
            
            function setupTabSwitching() {
                const tabButtons = document.querySelectorAll('.tab-button');
                
                tabButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        const tab = this.dataset.tab;
                        const isOPMLTab = this.classList.contains('opml-tab');
                        
                        if (isOPMLTab) {
                            // Handle OPML tabs
                            document.querySelectorAll('.opml-tab').forEach(b => b.classList.remove('active'));
                            document.querySelectorAll('.opml-content').forEach(c => c.classList.remove('active'));
                            this.classList.add('active');
                            document.getElementById(tab + '-tab').classList.add('active');
                        } else {
                            // Handle browse tabs
                            document.querySelectorAll('.tab-button:not(.opml-tab)').forEach(b => b.classList.remove('active'));
                            document.querySelectorAll('.tab-content:not(.opml-content)').forEach(c => c.classList.remove('active'));
                            this.classList.add('active');
                            document.getElementById(tab + '-tab').classList.add('active');
                        }
                    });
                });
            }
            
            function setupSearch() {
                // Daily comic table search
                const comicSearch = document.getElementById('comicSearch');
                const dailyTableRows = document.querySelectorAll('#comics-table-body tr');
                
                comicSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    dailyTableRows.forEach(row => {
                        const name = row.dataset.name;
                        if (name.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
                
                // Political comic table search
                const politicalComicSearch = document.getElementById('politicalComicSearch');
                const politicalTableRows = document.querySelectorAll('#political-comics-table-body tr');
                
                politicalComicSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    politicalTableRows.forEach(row => {
                        const name = row.dataset.name;
                        if (name.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
                
                // Daily comic list search
                const customFeedSearch = document.getElementById('customFeedSearch');
                const dailyCheckboxItems = document.querySelectorAll('#comics-list .form-check');
                
                customFeedSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    dailyCheckboxItems.forEach(item => {
                        const name = item.dataset.name;
                        if (name.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
                
                // Political comic list search
                const politicalFeedSearch = document.getElementById('politicalFeedSearch');
                const politicalCheckboxItems = document.querySelectorAll('#political-comics-list .form-check');
                
                politicalFeedSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    politicalCheckboxItems.forEach(item => {
                        const name = item.dataset.name;
                        if (name.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
                
                // Spanish comic table search
                const spanishComicSearch = document.getElementById('spanishComicSearch');
                const spanishTableRows = document.querySelectorAll('#spanish-comics-table-body tr');
                
                spanishComicSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    spanishTableRows.forEach(row => {
                        const name = row.dataset.name;
                        if (name.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
                
                // Spanish comic list search
                const spanishFeedSearch = document.getElementById('spanishFeedSearch');
                const spanishCheckboxItems = document.querySelectorAll('#spanish-comics-list .form-check');
                
                spanishFeedSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    spanishCheckboxItems.forEach(item => {
                        const name = item.dataset.name;
                        if (name.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
                
                // Tinyview comic table search
                const tinyviewComicSearch = document.getElementById('tinyviewComicSearch');
                const tinyviewTableRows = document.querySelectorAll('#tinyview-comics-table-body tr');
                
                tinyviewComicSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    tinyviewTableRows.forEach(row => {
                        const name = row.dataset.name;
                        if (name.includes(searchTerm)) {
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    });
                });
                
                // Tinyview comic list search
                const tinyviewFeedSearch = document.getElementById('tinyviewFeedSearch');
                const tinyviewCheckboxItems = document.querySelectorAll('#tinyview-comics-list .form-check');
                
                tinyviewFeedSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    
                    tinyviewCheckboxItems.forEach(item => {
                        const name = item.dataset.name;
                        if (name.includes(searchTerm)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            }
            
            function setupOPMLGeneration() {
                // Daily comics OPML
                const generateBtn = document.getElementById('generateOPMLBtn');
                const resetBtn = document.getElementById('resetSelectionBtn');
                const successMessage = document.getElementById('success-message');
                const downloadLink = document.getElementById('download-link');
                
                generateBtn.addEventListener('click', function() {
                    const selectedComics = [];
                    document.querySelectorAll('#comics-list .form-check-input:checked').forEach(checkbox => {
                        selectedComics.push(checkbox.value);
                    });
                    
                    if (selectedComics.length === 0) {
                        alert('Please select at least one comic.');
                        return;
                    }
                    
                    fetch('/.netlify/functions/generate-opml', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ comics: selectedComics, type: 'daily' }),
                    })
                    .then(response => response.blob())
                    .then(blob => {
                        const url = URL.createObjectURL(blob);
                        downloadLink.href = url;
                        downloadLink.download = 'daily-comics.opml';
                        successMessage.style.display = 'block';
                        
                        // Set up the download link
                        downloadLink.addEventListener('click', function(e) {
                            setTimeout(() => {
                                URL.revokeObjectURL(url);
                            }, 100);
                        });
                    })
                    .catch(error => {
                        console.error('Error generating OPML:', error);
                        alert('There was an error generating your OPML file. Please try again.');
                    });
                });
                
                resetBtn.addEventListener('click', function() {
                    document.querySelectorAll('#comics-list .form-check-input:checked').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    successMessage.style.display = 'none';
                });
                
                // Political comics OPML
                const generatePoliticalBtn = document.getElementById('generatePoliticalOPMLBtn');
                const resetPoliticalBtn = document.getElementById('resetPoliticalSelectionBtn');
                const politicalSuccessMessage = document.getElementById('political-success-message');
                const politicalDownloadLink = document.getElementById('political-download-link');
                
                generatePoliticalBtn.addEventListener('click', function() {
                    const selectedComics = [];
                    document.querySelectorAll('#political-comics-list .form-check-input:checked').forEach(checkbox => {
                        selectedComics.push(checkbox.value);
                    });
                    
                    if (selectedComics.length === 0) {
                        alert('Please select at least one political cartoon.');
                        return;
                    }
                    
                    fetch('/.netlify/functions/generate-opml', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ comics: selectedComics, type: 'political' }),
                    })
                    .then(response => response.blob())
                    .then(blob => {
                        const url = URL.createObjectURL(blob);
                        politicalDownloadLink.href = url;
                        politicalDownloadLink.download = 'political-cartoons.opml';
                        politicalSuccessMessage.style.display = 'block';
                        
                        // Set up the download link
                        politicalDownloadLink.addEventListener('click', function(e) {
                            setTimeout(() => {
                                URL.revokeObjectURL(url);
                            }, 100);
                        });
                    })
                    .catch(error => {
                        console.error('Error generating OPML:', error);
                        alert('There was an error generating your OPML file. Please try again.');
                    });
                });
                
                resetPoliticalBtn.addEventListener('click', function() {
                    document.querySelectorAll('#political-comics-list .form-check-input:checked').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    politicalSuccessMessage.style.display = 'none';
                });
                
                // Spanish comics OPML
                const generateSpanishBtn = document.getElementById('generateSpanishOPMLBtn');
                const resetSpanishBtn = document.getElementById('resetSpanishSelectionBtn');
                const spanishSuccessMessage = document.getElementById('spanish-success-message');
                const spanishDownloadLink = document.getElementById('spanish-download-link');
                
                generateSpanishBtn.addEventListener('click', function() {
                    const selectedComics = [];
                    document.querySelectorAll('#spanish-comics-list .form-check-input:checked').forEach(checkbox => {
                        selectedComics.push(checkbox.value);
                    });
                    
                    if (selectedComics.length === 0) {
                        alert('Please select at least one Spanish comic.');
                        return;
                    }
                    
                    fetch('/.netlify/functions/generate-opml', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ comics: selectedComics, type: 'spanish' }),
                    })
                    .then(response => response.blob())
                    .then(blob => {
                        const url = URL.createObjectURL(blob);
                        spanishDownloadLink.href = url;
                        spanishDownloadLink.download = 'spanish-comics.opml';
                        spanishSuccessMessage.style.display = 'block';
                        
                        // Set up the download link
                        spanishDownloadLink.addEventListener('click', function(e) {
                            setTimeout(() => {
                                URL.revokeObjectURL(url);
                            }, 100);
                        });
                    })
                    .catch(error => {
                        console.error('Error generating OPML:', error);
                        alert('There was an error generating your OPML file. Please try again.');
                    });
                });
                
                resetSpanishBtn.addEventListener('click', function() {
                    document.querySelectorAll('#spanish-comics-list .form-check-input:checked').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    spanishSuccessMessage.style.display = 'none';
                });
                
                // Tinyview comics OPML
                const generateTinyviewBtn = document.getElementById('generateTinyviewOPMLBtn');
                const resetTinyviewBtn = document.getElementById('resetTinyviewSelectionBtn');
                const tinyviewSuccessMessage = document.getElementById('tinyview-success-message');
                const tinyviewDownloadLink = document.getElementById('tinyview-download-link');
                
                generateTinyviewBtn.addEventListener('click', function() {
                    const selectedComics = [];
                    document.querySelectorAll('#tinyview-comics-list .form-check-input:checked').forEach(checkbox => {
                        selectedComics.push(checkbox.value);
                    });
                    
                    if (selectedComics.length === 0) {
                        alert('Please select at least one TinyView comic.');
                        return;
                    }
                    
                    fetch('/.netlify/functions/generate-opml', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ comics: selectedComics, type: 'tinyview' }),
                    })
                    .then(response => response.blob())
                    .then(blob => {
                        const url = URL.createObjectURL(blob);
                        tinyviewDownloadLink.href = url;
                        tinyviewDownloadLink.download = 'tinyview-comics.opml';
                        tinyviewSuccessMessage.style.display = 'block';
                        
                        // Set up the download link
                        tinyviewDownloadLink.addEventListener('click', function(e) {
                            setTimeout(() => {
                                URL.revokeObjectURL(url);
                            }, 100);
                        });
                    })
                    .catch(error => {
                        console.error('Error generating OPML:', error);
                        alert('There was an error generating your OPML file. Please try again.');
                    });
                });
                
                resetTinyviewBtn.addEventListener('click', function() {
                    document.querySelectorAll('#tinyview-comics-list .form-check-input:checked').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    tinyviewSuccessMessage.style.display = 'none';
                });
            }
        });
        
        function copyToClipboard(element) {
            const url = element.getAttribute('data-url');
            navigator.clipboard.writeText(url).then(() => {
                // Visual feedback
                if (element.classList.contains('copy-icon')) {
                    element.textContent = 'âœ“';
                    setTimeout(() => {
                        element.textContent = 'ğŸ“‹';
                    }, 2000);
                } else if (element.classList.contains('url-text')) {
                    const originalText = element.textContent;
                    element.textContent = 'Copied!';
                    element.style.color = '#4CAF50'; // Green color
                    setTimeout(() => {
                        element.textContent = originalText;
                        element.style.color = '';
                    }, 2000);
                }
            }).catch(err => {
                console.error('Could not copy text: ', err);
            });
        }
    </script>
</body>
</html> 